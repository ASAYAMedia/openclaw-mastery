<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guide 5: Automation & Cron ‚Äî OpenClaw Mastery</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        header {
            text-align: center;
            padding: 40px 20px;
            color: white;
        }
        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        .back-link {
            color: white;
            text-decoration: none;
            opacity: 0.8;
            display: inline-block;
            margin-bottom: 20px;
        }
        .back-link:hover { opacity: 1; }
        .content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }
        h2 {
            color: #667eea;
            margin: 30px 0 15px;
            font-size: 1.5em;
        }
        h3 {
            color: #764ba2;
            margin: 25px 0 10px;
            font-size: 1.2em;
        }
        p { margin-bottom: 15px; }
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
            margin: 20px 0;
        }
        pre code {
            background: none;
            padding: 0;
            color: inherit;
        }
        .warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        .tip {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 5px;
        }
        ul, ol {
            margin: 15px 0 15px 30px;
        }
        li { margin-bottom: 8px; }
        .step {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }
        .step-number {
            display: inline-block;
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 10px;
        }
        .highlight-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }
        .highlight-box h3 {
            color: white;
            margin-top: 0;
        }
        .code-block {
            background: #f8f9fa;
            border-left: 4px solid #764ba2;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
        }
        footer {
            text-align: center;
            padding: 40px;
            color: white;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="back-link">‚Üê Back to All Guides</a>
            <h5>‚öôÔ∏è Guide 5: Automation & Cron</h5>
            <p>Let your AI work while you sleep</p>
        </header>
        
        <div class="content">
            <div class="warning">
                <strong>Difficulty:</strong> Intermediate | <strong>Time:</strong> 50 minutes | <strong>Prerequisites:</strong> Guides 1-4
            </div>
            
            <div class="highlight-box">
                <h3>üéØ What You'll Build</h3>
                <p>An AI assistant that wakes up on schedule, checks your systems, summarizes your data, and reports back ‚Äî all automatically, 24/7.</p>
            </div>
            
            <p>Most people think of AI as something you chat with. But the real power comes when your AI works <strong>autonomously</strong> ‚Äî monitoring systems, scraping data, sending alerts, and generating reports without you lifting a finger.</p>
            
            <p>In this guide, we'll set up:</p>
            <ul>
                <li><strong>OpenClaw Cron</strong> ‚Äî Native scheduling system</li>
                <li><strong>Heartbeat tasks</strong> ‚Äî Periodic system checks</li>
                <li><strong>Auto-summaries</strong> ‚Äî Daily/weekly digests</li>
                <li><strong>Conditional alerts</strong> ‚Äî Notify when things need attention</li>
                <li><strong>Background agents</strong> ‚Äî Long-running tasks</li>
            </ul>
            
            <h2>Why Automation Matters</h2>
            
            <div class="code-block">
                <strong>Without automation:</strong> You remember to check email, calendar, news, stock prices, server status, backups... every day. Miss one? Something breaks.<br><br>
                <strong>With automation:</strong> Your AI checks everything automatically. You only hear about problems that actually need your attention.
            </div>
            
            <h2>Step 1: Understanding OpenClaw Cron</h2>
            
            <p>OpenClaw has a built-in cron system that's perfect for automation. It runs on the gateway (the process that manages your AI), not inside a single chat session.</p>
            
            <div class="step">
                <span class="step-number">1</span>
                <strong>Check Your Cron Status</strong>
                <p>First, verify the cron scheduler is running:</p>
                <pre><code># Check cron status
openclaw cron status

# Should show: "scheduler is active"</code></pre>
            </div>
            
            <h2>Step 2: Create Your First Scheduled Job</h2>
            
            <div class="step">
                <span class="step-number">2</span>
                <strong>Daily Summary Job</strong>
                <p>Let's create a job that runs every morning at 8 AM and summarizes your day:</p>
                <pre><code># Add a daily summary job
openclaw cron add \
  --name "daily-briefing" \
  --schedule "cron:0 8 * * *" \
  --message "Generate my daily briefing: check calendar, weather, and any pending tasks from yesterday" \
  --target main</code></pre>
            </div>
            
            <div class="tip">
                <strong>Cron syntax explained:</strong> <code>0 8 * * *</code> = At minute 0, hour 8, every day, every month, every weekday (8:00 AM daily)
            </div>
            
            <h2>Step 3: Heartbeat Tasks</h2>
            
            <p>Heartbeats are lightweight checks that run frequently. They're perfect for monitoring.</p>
            
            <div class="step">
                <span class="step-number">3</span>
                <strong>System Health Check</strong>
                <p>Every 30 minutes, check if important services are running:</p>
                <pre><code># Create heartbeat job
openclaw cron add \
  --name "health-check" \
  --schedule "every:1800000" \
  --message "Run HEARTBEAT.md checks: verify all services running, check disk space, review any alerts" \
  --target main</code></pre>
                <p>(1800000 ms = 30 minutes)</p>
            </div>
            
            <h2>Step 4: Build a Heartbeat.md File</h2>
            
            <p>Create a <code>HEARTBEAT.md</code> in your workspace that defines what to check:</p>
            
            <pre><code># HEARTBEAT.md - Automated System Checks

## Frequency: Every 30 minutes

### Check 1: Critical Services
- [ ] OpenClaw gateway running
- [ ] AI model responding
- [ ] Memory system (ChromaDB) accessible
- [ ] Messaging connections (Telegram/Discord) active

### Check 2: System Resources
- [ ] Disk space > 10% free
- [ ] Memory usage < 80%
- [ ] No zombie processes

### Check 3: Data Integrity
- [ ] Memory database backed up (if due)
- [ ] Logs rotating properly
- [ ] No errors in last 50 log lines

### Check 4: External Services
- [ ] Internet connectivity
- [ ] API rate limits not exceeded
- [ ] Cloud backups syncing (if enabled)

## Actions on Failure
- Alert via Telegram if critical service down
- Auto-restart non-critical services
- Log all failures to workspace/heartbeat-errors.log

## Daily at 8 AM: Generate Report
Summarize:
- Uptime percentage
- Any incidents
- Resource trends
- Recommendations</code></pre>
            
            <div class="step">
                <span class="step-number">4</span>
                <strong>Create the Heartbeat Handler</strong>
                <p>Save as <code>heartbeat_handler.py</code>:</p>
                <pre><code>#!/usr/bin/env python3
"""
Heartbeat Handler for OpenClaw
Runs periodic system checks and reports
"""

import subprocess
import psutil
import datetime
import os
from typing import List, Dict

class HeartbeatChecker:
    def __init__(self):
        self.log_file = "workspace/heartbeat.log"
        self.error_log = "workspace/heartbeat-errors.log"
    
    def run_all_checks(self) -> Dict:
        """Run all heartbeat checks and return results"""
        results = {
            "timestamp": datetime.datetime.now().isoformat(),
            "checks": []
        }
        
        # Check 1: OpenClaw gateway
        gateway_running = self._check_process("openclaw")
        results["checks"].append({
            "name": "OpenClaw Gateway",
            "status": "pass" if gateway_running else "fail",
            "message": "Running" if gateway_running else "Not running!"
        })
        
        # Check 2: Disk space
        disk = psutil.disk_usage('/')
        disk_ok = disk.percent < 90
        results["checks"].append({
            "name": "Disk Space",
            "status": "pass" if disk_ok else "warning",
            "message": f"{disk.percent}% used ({disk.free // (2**30)} GB free)"
        })
        
        # Check 3: Memory
        mem = psutil.virtual_memory()
        mem_ok = mem.percent < 85
        results["checks"].append({
            "name": "Memory",
            "status": "pass" if mem_ok else "warning",
            "message": f"{mem.percent}% used"
        })
        
        # Check 4: Internet
        net_ok = self._check_internet()
        results["checks"].append({
            "name": "Internet",
            "status": "pass" if net_ok else "fail",
            "message": "Connected" if net_ok else "No connection!"
        })
        
        return results
    
    def _check_process(self, name: str) -> bool:
        """Check if process is running"""
        for proc in psutil.process_iter(['name']):
            if name.lower() in proc.info['name'].lower():
                return True
        return False
    
    def _check_internet(self) -> bool:
        """Check internet connectivity"""
        try:
            import urllib.request
            urllib.request.urlopen('https://google.com', timeout=5)
            return True
        except:
            return False
    
    def generate_report(self, results: Dict) -> str:
        """Generate human-readable report"""
        report = f"üìä Health Check - {results['timestamp']}\n\n"
        
        for check in results["checks"]:
            emoji = "‚úÖ" if check["status"] == "pass" else "‚ö†Ô∏è" if check["status"] == "warning" else "‚ùå"
            report += f"{emoji} {check['name']}: {check['message']}\n"
        
        # Overall status
        all_pass = all(c["status"] == "pass" for c in results["checks"])
        if all_pass:
            report += "\n‚ú® All systems operational!"
        else:
            report += "\n‚ö†Ô∏è Some checks need attention"
        
        return report
    
    def log_results(self, results: Dict):
        """Log results to file"""
        with open(self.log_file, 'a') as f:
            f.write(f"{results['timestamp']}: {len([c for c in results['checks'] if c['status'] == 'pass'])}/{len(results['checks'])} checks passed\n")
    
    def run(self):
        """Main entry point"""
        results = self.run_all_checks()
        self.log_results(results)
        
        # Generate and return report
        report = self.generate_report(results)
        return report

# Run if called directly
if __name__ == "__main__":
    checker = HeartbeatChecker()
    print(checker.run())</code></pre>
            </div>
            
            <h2>Step 5: Advanced Cron Jobs</h2>
            
            <h3>Weekly Report</h3>
            <pre><code># Every Monday at 9 AM
openclaw cron add \
  --name "weekly-summary" \
  --schedule "cron:0 9 * * 1" \
  --message "Generate weekly report: summarize activities, check goal progress, plan priorities for this week"</code></pre>
            
            <h3>Monthly Cleanup</h3>
            <pre><code># First day of month at 3 AM
openclaw cron add \
  --name "monthly-cleanup" \
  --schedule "cron:0 3 1 * *" \
  --message "Archive old logs, compress memory database, clean temp files, review and optimize automation rules"</code></pre>
            
            <h3>One-Time Reminder</h3>
            <pre><code># Reminder for specific time
openclaw cron add \
  --name "project-deadline" \
  --schedule "at:1706740800000" \
  --message "Reminder: Project X deadline is in 24 hours! Review status and prepare deliverables."</code></pre>
            
            <h2>Step 6: Conditional Automation</h2>
            
            <p>Make your AI smarter ‚Äî only act when conditions are met:</p>
            
            <pre><code># Example: Alert only if disk space critical
import psutil

def check_and_alert():
    disk = psutil.disk_usage('/')
    
    if disk.percent > 95:
        # Send urgent alert
        return "üö® CRITICAL: Disk 95% full! Clean up now."
    elif disk.percent > 80:
        # Gentle reminder
        return "‚ö†Ô∏è Disk 80% full. Consider cleanup soon."
    else:
        # No message needed
        return None  # Silently pass

# In your heartbeat, only send message if result is not None</code></pre>
            
            <h2>Step 7: Background Agents</h2>
            
            <p>For long-running tasks, spawn isolated sessions:</p>
            
            <pre><code># Spawn a background agent for research
openclaw sessions_spawn \
  --task "Research all latest AI papers from arXiv this week, summarize the top 5, and prepare a briefing document" \
  --label "research-agent-001" \
  --timeout 3600

# This runs independently and reports back when done</code></pre>
            
            <div class="tip">
                <strong>Background vs Cron:</strong> Use cron for recurring tasks (every hour/day), background agents for one-time heavy tasks (research, data processing, report generation).
            </div>
            
            <h2>Step 8: Monitoring Your Automations</h2>
            
            <div class="step">
                <span class="step-number">5</span>
                <strong>View All Jobs</strong>
                <pre><code># List all cron jobs
openclaw cron list

# View recent runs
openclaw cron runs --job daily-briefing --limit 10</code></pre>
            </div>
            
            <h3>Job Run History</h3>
            <pre><code># Check if jobs are running properly
openclaw cron status

# Look for failures
openclaw cron runs --status failed --limit 20</code></pre>
            
            <h2>Sample Automation Stack</h2>
            
            <p>Here's a complete automation setup for productivity:</p>
            
            <pre><code># Morning routine (8 AM daily)
openclaw cron add --name "morning-brief" \
  --schedule "cron:0 8 * * *" \
  --message "Morning briefing: weather, calendar, tasks due today, unread messages summary"

# Health check (every 30 min)
openclaw cron add --name "health-check" \
  --schedule "every:1800000" \
  --message "Run HEARTBEAT.md checks"

# Afternoon focus (2 PM weekdays)
openclaw cron add --name "focus-check" \
  --schedule "cron:0 14 * * 1-5" \
  --message "Check progress on today's goals. What have you completed? What's blocking you?"

# Evening wind-down (9 PM)
openclaw cron add --name "evening-summary" \
  --schedule "cron:0 21 * * *" \
  --message "Daily summary: what was accomplished today? Log achievements and plan tomorrow's priorities"

# Weekly planning (Monday 8 AM)
openclaw cron add --name "weekly-plan" \
  --schedule "cron:0 8 * * 1" \
  --message "Weekly planning session: review last week's outcomes, set this week's goals, identify blockers"

# Monthly review (1st of month, 10 AM)
openclaw cron add --name "monthly-review" \
  --schedule "cron:0 10 1 * *" \
  --message "Monthly strategic review: goal progress, habit tracking, system optimizations, celebrate wins"</code></pre>
            
            <h2>Troubleshooting</h2>
            
            <h3>"Cron job not running"</h3>
            <ul>
                <li>Check gateway is running: <code>openclaw gateway status</code></li>
                <li>Verify job is enabled: <code>openclaw cron list --include-disabled</code></li>
                <li>Check timezone settings match your local time</li>
            </ul>
            
            <h3>"Job runs but nothing happens"</h3>
            <ul>
                <li>Check the message text is valid and triggers expected actions</li>
                <li>Review gateway logs for errors</li>
                <li>Test the message manually in a chat session first</li>
            </ul>
            
            <h3>"Too many notifications"</h3>
            <ul>
                <li>Add conditional logic ‚Äî only alert on actual problems</li>
                <li>Batch multiple checks into one summary</li>
                <li>Use different channels (email for urgent, chat for routine)</li>
            </ul>
            
            <h2>Next Steps</h2>
            
            <ul>
                <li>‚úÖ <strong>Smart alerts</strong> ‚Äî Only notify when thresholds crossed</li>
                <li>‚úÖ <strong>API integrations</strong> ‚Äî Connect to calendars, task managers, monitoring tools</li>
                <li>‚úÖ <strong>Decision trees</strong> ‚Äî Auto-escalate issues through multiple channels</li>
                <li>‚úÖ <strong>ML predictions</strong> ‚Äî Predict problems before they happen</li>
            </ul>
            
            <p style="margin-top: 40px; text-align: center;">
                <a href="guide-06-tools.html" style="display: inline-block; background: #667eea; color: white; padding: 15px 40px; text-decoration: none; border-radius: 50px; font-weight: bold;">Next: Guide 6 ‚Äî Add 20+ Tools ‚Üí</a>
            </p>
        </div>
        
        <footer>
            <p>¬© 2026 OpenClaw Mastery ‚Äî <a href="index.html" style="color: white;">Back to Home</a></p>
        </footer>
    </div>
</body>
</html>